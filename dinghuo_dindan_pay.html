<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no">
		<meta name="format-detection" content="telephone=no">
		<meta name="keywords" content=" ">
		<meta name="description" content=" ">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<link rel="stylesheet" type="text/css" href="font-awesome-4.7.0/css/font-awesome.min.css" />
		<link rel="stylesheet" type="text/css" href="css/zui.min.css" />
		<link rel="stylesheet" href="css/jquery.ui.css" type="text/css" />
		<link rel="stylesheet" type="text/css" href="css/css.css" />
		<link rel="stylesheet" type="text/css" href="css/scarlett.css" />
	</head>

	<body>
		<h3 class="col-md-12 title "><a class="dthis" href="">订货单</a><span class="bread">&gt;</span><a href="">订单详情</a></h3>
		<div class="col-md-12 con ">
			<div class="panel panel-default">
				<div class="wrap1">
					<div class="goods_detal_blok">
						<div class="goods_detal_list">
							<label>订单号：</label><span></span>
						</div>
						<div class="goods_detal_list">
							<label>下单时间：</label><span>2016-12-15 14:30</span>
						</div>
						<div class="goods_detal_list">
							<label>商家名称：</label><span></span>
						</div>
						<div class="goods_detal_list">
							<label>订单状态：</label><span></span>
						</div>
						<div class="goods_detal_list">
							<label>付款状态：</label><span></span>
						</div>
						<div class="goods_detal_list">
							<label>订单金额：</label><span></span>
						</div>
						<div class="goods_detal_list">
							<label>待付金额：</label><span></span>
						</div>
					</div>
				</div>
				<div class="fund-table1">
					<h3 class="col-md-12 title title1 bok-o-t"><a href="">订单详情</a><a href="">出库/发货/物流</a><a class="dthis" href="">付款记录</a></h3>
					<div class="goods_table_head">
						<div class="table_headL">
							<label>应付金额：￥<span>100.00</span></label>
							<label>已付金额：￥<span>30.00</span></label>
							<label>待付金额：￥<span>70.00</span></label>
						</div>
						<div class="table_headR">
							<!--<div class="table_headRL">
								<a class="print" href="#" style="display: none;" ><i class="fa fa-print"></i>打印</a>
								<a class="export" href="#" style="display: none;"><i class="fa  fa-upload"></i>导出</a>
							</div>-->
							<div class="table_headRR">
								<!--<button class="modify" type="button">修改商品</button>-->
								<!--<button class="cancel" type="button" style="display: none;">取消入库</button>-->
								<a class="pass" href="#跳转到添加收款记录页">付款</a>
							</div>
						</div>
					</div>
					<table class="table table-cus">
						<thead>
							<tr>
								<th></th>
								<th width="20%">单号</th>
								<th>时间</th>
								<th>收款金额</th>
								<th>支付方式</th>
								<th>收款账号</th>
								<th>付款状态</th>
								<th>商品备注</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>1</td>
								<td>FP.20161219.0006</td>
								<td>2016-12-19 14:38</td>
								<td>30</td>
								<td>线下转账</td>
								<td>
									<div class="tdBlock">
										<a href="#">RK.20160810.0010</a>
										<span>2016-12-12 09:22</span>
									</div>
								</td>
								<td class="wait">待确认</td>
								<td><textarea></textarea></td>
								<td class="tbody-eit">
									<a class="rowAffirm" href="#">确认</a><a class="rowCancel" href="#">取消</a><a class="rowDetail" href="#">查看</a>
								</td>
							</tr>
							<tr>
								<td>2</td>
								<td>FP.20161219.0005</td>
								<td>2016-12-19 14:38</td>
								<td>30</td>
								<td>线下转账</td>
								<td>
									<div class="tdBlock">
										<a href="#">RK.20160810.0010</a>
										<span>2016-12-12 09:22</span>
									</div>
								</td>
								<td class="wait">已确认</td>
								<td><textarea></textarea></td>
								<td class="tbody-eit">
									<a class="rowDetail" href="#">查看</a>
								</td>
							</tr>
							<tr>
								<td>3</td>
								<td>FP.20161219.0007</td>
								<td>2016-12-19 14:38</td>
								<td>100</td>
								<td>线下转账</td>
								<td>
									<div class="tdBlock">
										<a href="#">RK.20160810.0010</a>
										<span>2016-12-12 09:22</span>
									</div>
								</td>
								<td class="wait">待确认</td>
								<td><textarea></textarea></td>
								<td class="tbody-eit">
									<a class="rowAffirm" href="#">确认</a><a class="rowCancel" href="#">取消</a><a class="rowDetail" href="#">查看</a>
								</td>
							</tr>
						</tbody>
					</table>
					<div class="desBottom">
						<a href="#">返回</a>
					</div>
				</div>
			</div>
		</div>
		
		<!--弹窗-->
		<div class="dialog modal fade js-message-modal in inventoryConfirm" style="display: none;">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h4 class="modal-title">确认收款</h4>
					</div>
					<div class="modal-body">
						<h4 class="text-center">是否确认收款?</h4>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-info">确定</button>
						<button type="button" class="btn btn-default">取消</button>
						<div class="desBottom" style="display: none;"><a href="#">关闭</a></div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal-backdrop fade in inventoryConfirmBak" style="display: none;"></div>
		
				<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
				<script type="text/javascript" src="js/jquery.ui.js"></script>
				<script type="text/javascript" src="js/moment.min.js"></script>
				<script type="text/javascript" src="js/stay1.js"></script>
				<script type="text/javascript">
					$(document).ready(function() {
						$(".fund-table1 .rowAffirm").click(function() {
							var thisTd=$(this).parent().parent().find("td");
							var thisMoney=parseFloat($(thisTd[3]).text());
							var moneySpan=$(".table_headL>label>span");
							var payable =parseFloat($(moneySpan[0]).text());
							var paid=parseFloat($(moneySpan[1]).text());
							var unpaid=(payable-paid).toFixed(2);
							var distance=payable-(thisMoney+paid);
							var positiveDist=0;
							if(distance<0){
								positiveDist=-(distance);
							}else{
								positiveDist=distance;
							}
							$(".inventoryConfirm").css("display", "block");
							$(".inventoryConfirmBak").css("display", "block");
							if(distance>=0){
								$(".inventoryConfirm .modal-body h4").html('是否确认收款？');								
							}else{
								$(".inventoryConfirm .modal-body h4").html('<p>本次待确认收款的款项（<b>'+payable+'</b>）大于该订单应付金额（<b>'+unpaid+'</b>）;</p><p>超出的余额（<b>'+positiveDist+'</b>）会自动存入该客户的预存款账户;</p>');
							}
						})
						$(".fund-table1 .rowCancel").click(function(){
							var thisTd=$(this).parent().parent().find("td");
							var thisMoney=parseFloat($(thisTd[3]).text()).toFixed(2);
							var orderNum=$(thisTd[1]).text();
							$(".inventoryConfirm").css("display", "block");
							$(".inventoryConfirmBak").css("display", "block");
							$(".inventoryConfirm .modal-header h4").html("取消付款");
							$(".inventoryConfirm .modal-body h4").html('<p>若取消该订单的付款记录，将同时取消该订单的收款记录</p><p>【收款记录】<span>'+orderNum+'</span>&nbsp;&nbsp;订单付款&nbsp;&nbsp;-<b>'+thisMoney+'</b></p><textarea placeholder="请填写取消的原因"></textarea>');
						})
						$(".fund-table1 .rowDetail").click(function(){
							$(".inventoryConfirm").css("display", "block");
							$(".inventoryConfirmBak").css("display", "block");
							$(".inventoryConfirm button").css("display", "none");
							/*$(".inventoryConfirm .desBottom").css("display", "none");*/
							$(".inventoryConfirm .desBottom").css("display", "block");
							$(".inventoryConfirm .modal-header h4").html("付款记录详情");
/*							var nameHtml='<div class="checkblok1"><label>单号：<span>FP.20161220.0013</span></label></div>';
							var accountHtml='<div class="checkblok1"><label>单号：<span>FP.20161220.0013</span></label><label>金额：<span>-100.0000</span></label><label>收支类型：<span></span></label><label>状态：<span>待确认</span></label></div>';
							var payHtml='<div class="checkblok1"><label>支付方式：<span>线下转账</span></label><label>付款日期：<span>2016-12-20</span></label><label>收款账号：<span>开户银行：中国银行金牛荷花池支行</span><br><span>开户名称：成都箱包商贸</span><br><span>银行账号：34353-5353-5335-01</span></label><label>状态：<span>待确认</span></label></div>';
							var timeHtml='<div class="checkblok1"><label>提交时间：<span>2016-12-20 09:49</span><span>内部-p1031</span></label><label>审核确认时间：<span>2016-12-20</span></label><label>备注：<span>待确认</span></label><label>附件：<span>待确认</span></label></div>';*/
							var nameHtml='<div class="checkblok1"><div class="labelBlk"><label>客户名称：</label><span>昆明玉龙商贸有限公司</span></div></div>';
							var accountHtml='<div class="checkblok1"><div class="labelBlk"><label>单号：</label><span>FP.20161220.0013</span></div><div class="labelBlk"><label>金额：</label><span>-100.0000</span></div><div class="labelBlk"><label>收支类型：</label><span></span></div><div class="labelBlk"><label>状态：</label><span>待确认</span></div></div>';
							var payHtml='<div class="checkblok1"><div class="labelBlk"><label>支付方式：</label><span>线下转账</span></div><div class="labelBlk"><label>付款日期：</label><span>2016-12-20</span></div><div class="labelBlk"><label>收款账号：</label><span>开户银行：中国银行金牛荷花池支行</span><span>开户名称：成都箱包商贸</span><span>银行账号：34353-5353-5335-01</span></div><div class="labelBlk"><label>状态：</label><span>待确认</span></div></div>';
							var timeHtml='<div class="checkblok1"><div class="labelBlk"><label>提交时间：</label><span>2016-12-20 09:49</span><span>内部-p1031</span></div><div class="labelBlk"><label>审核确认时间：</label><span>2016-12-20</span></div><div class="labelBlk"><label>备注：</label><span>待确认</span></div><div class="labelBlk"><label>附件：</label><span>待确认</span></div></div>';
							$(".inventoryConfirm .modal-body h4").html(nameHtml+accountHtml+payHtml+timeHtml);
							//$(".inventoryConfirm .modal-footer").html('<div class="desBottom"><a href="#">关闭</a></div>');
						})
						
						$(".inventoryConfirm .btn.btn-default").click(function() {
							$(".inventoryConfirm").css("display", "none");
							$(".inventoryConfirmBak").css("display", "none");
						})
						$(".inventoryConfirm .desBottom").click(function() {
							$(".inventoryConfirm").css("display", "none");
							$(".inventoryConfirmBak").css("display", "none");
						})

					})
				</script>
	</body>

</html>