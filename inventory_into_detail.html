<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no">
		<meta name="format-detection" content="telephone=no">
		<meta name="keywords" content=" ">
		<meta name="description" content=" ">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<link rel="stylesheet" type="text/css" href="font-awesome-4.7.0/css/font-awesome.min.css" />
		<!--<link rel="stylesheet" type="text/css" href="css/zui.min.css" />
		<link rel="stylesheet" type="text/css" href="css/chosen.min.css" />
		<link rel="stylesheet" href="css/jquery.ui.css" type="text/css" />-->
		<link rel="stylesheet" type="text/css" href="css/css.css" />
		<link rel="stylesheet" type="text/css" href="css/scarlett.css" />
	</head>

	<body>
		<h3 class="col-md-12 title "><a class="dthis" href="">入库单</a><span class="bread">&gt;</span><a href="">入库明细</a></h3>
		<div class="col-md-12 con ">
			<div class="panel panel-default">
				<div class="wrap1">
					<div class="goods_detal_blok">
						<div class="goods_detal_list">
							<label>入库单号：</label><span>RK.20161209.0002</span>
						</div>
						<div class="goods_detal_list">
							<label>入库时间：</label><span>2016-12-09 13:24</span>
						</div>
						<div class="goods_detal_list">
							<label>入库仓库：</label><span>大河仓库</span>
						</div>
						<div class="goods_detal_list">
							<label>入库类型：</label><span>采购入库</span>
						</div>
						<div class="goods_detal_list">
							<label>经办人：</label><span>订货宝</span>
						</div>
						<div class="goods_detal_list">
							<label>供应商：</label><span></span>
						</div>
						<div class="goods_detal_list">
							<label>审核状态：</label><span>待审核</span>
						</div>
					</div>
				</div>
				<div class="fund-table1">
					<div class="goods_table_head">
						<h2>商品信息</h2>
						<div class="table_headR">
							<div class="table_headRL">
								<a class="print" href="#"><i class="fa fa-print"></i>打印</a>
								<a class="export" href="#"><i class="fa  fa-upload"></i>导出</a>
							</div>
							<div class="table_headRR">
								<button class="cancel" type="button">取消入库</button>
								<button class="pass" type="button">通过审核</span>
							</div>
						</div>
					</div>
					<table class="table table-cus">
						<thead>
							<tr>
								<th></th>
								<th>商品</th>
								<th>商品规格</th>
								<th>单位</th>
								<th>辅助数量</th>
								<th>入库数量</th>
								<th>进货价</th>
								<th>备注</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>1</td>
								<td>
									<div class="detail_block">
										<img src="img/goods.png" alt="" />
										<p class="list-link1">10094</p>
										<a class="list-link2">百年纪念高跟鞋2016夏季新款单鞋细跟女鞋尖头鞋子呵呵1</a>
									</div>
								</td>
								<td>酒红色</td>
								<td>个</td>
								<td>2</td>
								<td>
									<div class="cfs pull-left">
										<a class="jian">-</a><input class="lskdo" type="text" value="2">
										<a class="jia">+</a>
									</div>
								</td>
								<td>33.44</td>
								<td></td>
							</tr>
							<tr>
								<td>3</td>
								<td>
									<div class="detail_block">
										<img src="img/goods.png" alt="" />
										<p class="list-link1">10094</p>
										<a class="list-link2">百年纪念高跟鞋2016夏季新款单鞋细跟女鞋尖头鞋子呵呵1</a>
									</div>
								</td>
								<td>酒红色</td>
								<td>个</td>
								<td>9</td>
								<td>
									<div class="cfs pull-left">
										<a class="jian">-</a><input class="lskdo" type="text" value="3">
										<a class="jia">+</a>
									</div>
								</td>
								<td>12.4</td>
								<td></td>
							</tr>
							<tr>
								<td>合计</td>
								<td><span></span>种</td>
								<td colspan="3"></td>
								<td>11</td>
								<td></td>
								<td></td>
							</tr>
						</tbody>
						<tfoot>
							<tr>
								<td colspan="100" class="">

									<nav class="pull-right">
										<ul class="pagination">
											<li>
												<a href="#">&laquo;</a>
											</li>
											<li>
												<a href="#">1</a>
											</li>
											<li>
												<a href="#">2</a>
											</li>
											<li>
												<a href="#">3</a>
											</li>
											<li>
												<a href="#">4</a>
											</li>
											<li>
												<a href="#">5</a>
											</li>
											<li>
												<a href="#">&raquo;</a>
											</li>
										</ul>
									</nav>

								</td>

							</tr>
						</tfoot>
					</table>

				</div>
				<div class="bottomTablCont" >
					<h2>操作日志<i class="fa fa-caret-down"></i></h2>
					<div class="bottomTablBlock">
					<table class="table table-cus">
						<thead>
							<tr>
								<th>操作时间</th>
								<th>操作人员</th>
								<th>操作类型</th>
								<th>操作日志</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>2016-12-10 17:10</td>
								<td>订货宝</td>
								<td>创建入库单</td>
								<td ></td>
							</tr>
						</tbody>
					</table>						
					</div>
				</div>
			</div>

		</div>
		
		<!--弹窗-->
		<div class="dialog modal fade js-message-modal in inventoryConfirm" style="display: none;">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h4 class="modal-title">入库单</h4>
					</div>
					<div class="modal-body">
						<h4 class="text-center">确定审核通过?</h4></div>
					<div class="modal-footer">
						<button type="button" class="btn btn-info">确定</button>
						<button type="button" class="btn btn-default">取消</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal-backdrop fade in inventoryConfirmBak" style="display: none;"></div>

		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
				<!--		<script src="js/zui.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="js/chosen.min.js" charset="utf-8"></script>
		<script type="text/javascript" src="js/jquery.ui.js"></script>
		<script type="text/javascript" src="js/moment.min.js"></script>
		<script type="text/javascript" src="js/stay1.js"></script>-->
				<script type="text/javascript">
					$(document).ready(function() {

						var goods_detal_listStr=$(".goods_detal_blok .goods_detal_list:last-child").find("span").text();
						if(goods_detal_listStr=="已审核"){
							$(".table_headRR").css("display","none");
						}else{
							$(".table_headRR").css("display","block");
						}
						/*操作日志控制*/
						/*var bottomTablContI=$(".bottomTablCont h2>i");
						bottomTablContI.click(function(){
							var thisParent=$(this).parent().parent().find(".bottomTablBlock");
							if($(thisParent).css("display")=="block"){
								$(this).addClass("fa fa-caret-down");
								$(thisParent).css("display","none");
							}else{
								$(this).addClass("fa fa-caret-up");						
								$(thisParent).css("display","block");

							}
						})*/
						/*取消和通过审核操作*/
						$(".table_headRR .cancel").click(function() {
							$(".inventoryConfirm").css("display","block");
							$(".inventoryConfirmBak").css("display","block");
							$(".inventoryConfirm .modal-header h4").html("取消入库单");
							$(".inventoryConfirm .modal-body h4").html('确定取消该入库单！<br><div class="m-t-20 padder"><textarea class="form-control l-h-30" name="cancel_reason" id="cancel_reason" placeholder="请输入备注" value="" cols="50" rows="3"></textarea></div>');
							
						})
						$(".table_headRR .pass").click(function() {
							$(".inventoryConfirm").css("display","block");
							$(".inventoryConfirmBak").css("display","block");
							$(".inventoryConfirm .modal-header h4").html("入库单");
							$(".inventoryConfirm .modal-body h4").html('确定审核通过?');
						})
						$(".inventoryConfirm .btn.btn-default").click(function(){
							$(".inventoryConfirm").css("display","none");
							$(".inventoryConfirmBak").css("display","none");
						})
						var detail_listLen = $(".fund-table1 table tbody tr");
						/*使得辅助等于入库*/
						/*for(var i=0;i<detail_listLen.length-1;i++){
							$($(detail_listLen[i]).find('td')[5]).find("input").val($($(detail_listLen[i]).find('td')[4]).text());
						}*/
						nunberTal();

						function nunberTal() {
							var goods_pri_inp_tal = 0;

							var detail_numLen = detail_listLen.length - 1;
							var detail_numAry = [];
							var detail_numTal = 0;
							for(var i = 0; i < detail_listLen.length - 1; i++) {
								$($(detail_listLen[i]).find('td')[4]).html($($(detail_listLen[i]).find('td')[5]).find("input").val());
							}
							for(var detl_index = 0; detl_index < detail_listLen.length - 1; detl_index++) {
								var detail_numVal = parseInt($($(detail_listLen[detl_index]).find("td")[4]).text());
								detail_numTal += detail_numVal;
								detail_numAry.push(detail_numVal);
							}
							var detail_priAry = [];
							for(var detl_index1 = 0; detl_index1 < detail_listLen.length - 1; detl_index1++) {
								var detail_priVal = parseFloat($($(detail_listLen[detl_index1]).find("td")[6]).text());
								detail_priAry.push(detail_priVal);
							}
							for(var s3 = 0; s3 < detail_listLen.length - 1; s3++) {
								goods_pri_inp_tal += (parseInt(detail_numAry[s3]) * parseFloat(detail_priAry[s3]));
							}
							$($($(detail_listLen[detail_numLen]).find("td")[1]).find("span")[0]).html(detail_numLen);
							$($($(detail_listLen[detail_numLen]).find("td")[3])).html(detail_numTal);
							$($($(detail_listLen[detail_numLen]).find("td")[4])).html(goods_pri_inp_tal.toFixed(2));
						}

						/*for(var i=0;i<detail_listLen.length-1;i++){
							$($(detail_listLen[i]).find('td')[5]).find("input").val($($(detail_listLen[i]).find('td')[4]).text());
						}
						var detail_numAry=[];
						var detail_numTal=0;
						for(var detl_index=0;detl_index<detail_listLen.length-1;detl_index++){
							detail_numTal+=parseInt($($(detail_listLen[detl_index]).find("td")[4]).text());
						}*/

						plusMinus();
						/*商品数量的加减*/
						function plusMinus() {
							$(".jian").prop('onclick', null).off('click').click(function() {
								var lsoek = $(this).parent().find(".lskdo");
								var lsoek_pre = $(this).parent().parent().prev();
								var lskoe = parseInt(lsoek.val());
								if(lskoe) {
									if(lskoe > 1) {
										lsoek.val(lskoe - 1);
										lsoek_pre.html(lskoe - 1);
										nunberTal();
									} else {
										lsoek.val(lskoe);
									}
								} else {
									lsoek.val(1);
									lskoe = 1;
								}
							})

							$(".jia").prop('onclick', null).off('click').click(function(e, iiii) {
								var lsoek = $(this).parent().find(".lskdo");
								var lsoek_pre = $(this).parent().parent().prev();
								var lskoe = parseInt(lsoek.val());
								if(lskoe) {
									lsoek.val(lskoe + 1);
									lsoek_pre.html(lskoe + 1);
									nunberTal();
								} else {
									lsoek.val(1);
									lskoe = 1;
								}

							})
						}

						/*编辑数量*/
						editNumber();

						function editNumber() {
							$(".lskdo").keyup(function() {
								var lsoek = $(this);
								var lskoe = parseInt(lsoek.val());
								if(lskoe) {
									lsoek.val(lskoe);
								} else {
									lsoek.val(1);
									lskoe = 1;
								}
								nunberTal();
							});
						}
					})
				</script>
	</body>

</html>